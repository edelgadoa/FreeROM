///////////////
// FreeROM 
///////////////

/////////////////////////////////////////
//// NS + VMS-Smago + Estab Pres (LPS)///
/////////////////////////////////////////

// Codigo para resolver el problema de EF de VMS-Smago con estabilizacion LPS en la presion. 
// Elemento Finito P2-P2 (no estable) en vel-pres 


// Cargamos librerias
load "iovtk" 

// Cargamos macros
include "../../Auxiliary/Macros_2D.idp"

// Creamos la matriz
include "../../Mallas/CuadradoNxNy.idp"

// Definimos los espacios de EF y de los EF globales
include "FE_Spaces_NoStab_VP_2D.idp"

Vh3P2 [u1, u2, p];
VhP1dc u1dx, u1dy, u2dx, u2dy; 
VhP1dc Gr; // Para el termino de VMS-Smagorinsky

// Definimos las matrices de interpolacion y derivacion
include "Interp_matrix_NoStab_VP_2D.idp"

// Definimos los parametros a usar
include "Parametros_2D.idp"

<<<<<<< HEAD
Reynolds = 1000;


/////////////////////////////////////////////
// Resolvemos el problema de EF: Cavidad 2D//
/////////////////////////////////////////////

Vh3P2 [uEF, uEFY, uEFP]; 
VhP1dc uEFdX, uEFdY, uEFYdX, uEFYdY; //las derivadas de uEF del paso anterior CON LEVANTAMIENTO
VhP2 uprevL, uprevLY; // La sol del paso anterior con Levantamiento
VhP1dc Gr; // Para el termino de VMS-Smagorinsky

include "FE_VMS_LPS_2D.idp"

// Dibujamos la solucion, con levantamiento

VhP2 uEFL, uEFLY;
uEFL = uEF + Lev1;
uEFLY = uEFY + Lev2; 

plot([uEFL, uEFLY], cmm="FE vel para Re="+Reynolds);
plot(uEFP, cmm="FE pres para Re="+Reynolds);
=======
>>>>>>> parent of 744071c (Codigo de EF VMS-LPS)
